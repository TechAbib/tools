<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Contao CMS 3.2.4 Code Execution Vulnerability</title><style id="ya_share_style" type="text/css">.b-share-popup-wrap{z-index:1073741823;position:absolute;width:500px}.b-share-popup{position:absolute;z-index:1073741823;border:1px solid #888;background:#FFF;color:#000}.b-share-popup-wrap .b-share-popup_down{top:0}.b-share-popup-wrap .b-share-popup_up{bottom:0}.b-share-popup-wrap_state_hidden{position:absolute!important;top:-9999px!important;right:auto!important;bottom:auto!important;left:-9999px!important;visibility:hidden!important}.b-share-popup,x:nth-child(1){border:0;padding:1px!important}@media all and (resolution=0){.b-share-popup,x:nth-child(1),x:-o-prefocus{padding:0!important;border:1px solid #888}}.b-share-popup__i{display:-moz-inline-box;display:inline-block;padding:5px 0!important;overflow:hidden;vertical-align:top;white-space:nowrap;visibility:visible;background:#FFF;-webkit-box-shadow:0 2px 9px rgba(0,0,0,.6);-moz-box-shadow:0 2px 9px rgba(0,0,0,.6);box-shadow:0 2px 9px rgba(0,0,0,.6)}.b-share-popup__item{font:1em/1.25em Arial,sans-serif;display:block;padding:5px 15px!important;white-space:nowrap;background:#FFF}.b-share-popup__item,a.b-share-popup__item:link,a.b-share-popup__item:visited{text-decoration:none!important;border:0!important}a.b-share-popup__item{cursor:pointer}a.b-share-popup__item .b-share-popup__item__text{display:inline;text-decoration:underline;color:#1A3DC1}a.b-share-popup__item:hover{word-spacing:0}a.b-share-popup__item:hover .b-share-popup__item__text{color:red;cursor:pointer}.b-share-popup__icon{display:-moz-inline-box;display:inline-block;margin:-3px 0 0;padding:0 5px 0 0!important;vertical-align:middle}.b-share-popup__icon_input{width:21px;height:16px;margin-top:-6px;padding:0!important}.b-share-popup__icon__input{margin-right:0;margin-left:2px;vertical-align:top}.b-share-popup__spacer{display:block;padding-top:10px!important}.b-share-popup__header{font:86%/1em Verdana,sans-serif;display:block;padding:10px 15px 5px!important;color:#999}.b-share-popup__header_first{padding-top:5px!important}.b-share-popup__input{font:86%/1em Verdana,sans-serif;display:block;padding:5px 15px!important;color:#999;text-align:left}.b-share-popup__input__input{font:1em/1em Verdana,sans-serif;display:block;width:10px;margin:5px 0 0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:none;text-align:left;direction:ltr}.b-share-popup_down .b-share-popup_with-link .b-share-popup__input_link{position:absolute;top:5px;right:0;left:0}.b-share-popup_up .b-share-popup_with-link .b-share-popup__input_link{position:absolute;right:0;bottom:5px;left:0}.b-share-popup_down .b-share-popup_with-link{padding-top:55px!important}.b-share-popup_up .b-share-popup_with-link{padding-bottom:55px!important}.b-share-popup_down .b-share-popup_expandable .b-share-popup__main{padding-bottom:25px!important}.b-share-popup_up .b-share-popup_expandable .b-share-popup__main{padding-top:25px!important}.b-share-popup_down .b-share-popup_yandexed{padding-bottom:10px!important}.b-share-popup_up .b-share-popup_yandexed{padding-top:10px!important}.b-share-popup__yandex{position:absolute;right:4px;bottom:2px;font:78.125%/1em Verdana,sans-serif;padding:3px!important;background:0 0}a.b-share-popup__yandex:link,a.b-share-popup__yandex:visited{color:#C6C5C5;text-decoration:none}a.b-share-popup__yandex:link:hover,a.b-share-popup__yandex:visited:hover{color:red;text-decoration:underline}.b-share-popup_up .b-share-popup__yandex{top:2px;bottom:auto}.b-share-popup_expandable .b-share-popup__yandex{right:auto;left:4px}.b-share-popup_to-right .b-share-popup_expandable .b-share-popup__yandex{right:4px;left:auto}.b-share-popup__expander .b-share-popup__item{position:absolute;bottom:5px;font:86%/1em Verdana,sans-serif;margin:10px 0 0;padding:5px 10px!important;cursor:pointer;color:#999;background:0 0}.b-share-popup_to-right,.b-share-popup_to-right .b-share-popup__expander{direction:rtl}.b-share-popup_to-right .b-share-popup__expander .b-share-popup__icon{padding:0 0 0 5px!important}.b-share-popup_up .b-share-popup__expander .b-share-popup__item{top:-5px;bottom:auto}.b-share-popup__expander .b-share-popup__item:hover .b-share-popup__item__text{text-decoration:underline}.b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup__expander .b-ico_action_larr,.b-share-popup_full .b-share-popup__expander .b-ico_action_larr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup__expander .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__item__text_expand{display:none}.b-share-popup_to-right .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_full .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_larr{display:inline}.b-ico_action_rarr,.b-ico_action_larr{width:8px;height:7px;border:0}.b-share-popup__main,.b-share-popup__extra{direction:ltr;vertical-align:bottom;text-align:left}.b-share-popup_down .b-share-popup__main,.b-share-popup_down .b-share-popup__extra{vertical-align:top}.b-share-popup__main{display:-moz-inline-stack;display:inline-block}.b-share-popup__extra{display:none;margin:0 -10px 0 0}.b-share-popup_full .b-share-popup__extra{display:-moz-inline-stack;display:inline-block}.b-share-popup_to-right .b-share-popup__extra{margin:0 0 0 -10px}.b-share-popup__tail{position:absolute;width:21px;height:10px;margin:0 0 0 -11px}.b-share-popup_down .b-share-popup__tail{top:-10px;background:url("//yastatic.net/share/static/b-share-popup_down__tail.gif") 0 0 no-repeat}.b-share-popup_up .b-share-popup__tail{bottom:-10px;background:url("//yastatic.net/share/static/b-share-popup_up__tail.gif") 0 0 no-repeat}.b-share-popup_down .b-share-popup__tail,x:nth-child(1){top:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.png")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1){bottom:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.png")}@media all and (resolution=0){.b-share-popup_down .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{top:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.gif")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{bottom:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.gif")}}.b-share-popup .b-share-popup_show_form_mail,.b-share-popup .b-share-popup_show_form_html{padding:0!important}.b-share-popup .b-share-popup_show_form_mail .b-share-popup__main,.b-share-popup .b-share-popup_show_form_html .b-share-popup__main,.b-share-popup .b-share-popup_show_form .b-share-popup__main,.b-share-popup .b-share-popup_show_form_mail .b-share-popup__extra,.b-share-popup .b-share-popup_show_form_html .b-share-popup__extra,.b-share-popup .b-share-popup_show_form .b-share-popup__extra{height:15px;padding:0!important;overflow:hidden;visibility:hidden}.b-share-popup_show_form_mail .b-share-popup__expander,.b-share-popup_show_form_html .b-share-popup__expander,.b-share-popup_show_form .b-share-popup__expander,.b-share-popup_show_form_mail .b-share-popup__input_link,.b-share-popup_show_form_html .b-share-popup__input_link,.b-share-popup_show_form .b-share-popup__input_link{display:none}.b-share-popup__form{position:relative;display:none;overflow:hidden;padding:5px 0 0!important;margin:0 0 -15px;white-space:normal}.b-share-popup_show_form_mail .b-share-popup__form_mail,.b-share-popup_show_form_html .b-share-popup__form_html,.b-share-popup_show_form .b-share-popup__form{display:block}.b-share-popup__form__link{padding:5px!important;margin:0 0 5px 10px;text-decoration:underline;cursor:pointer;color:#1A3DC1}.b-share-popup__form__link,.b-share-popup__form__button{font:86%/1.4545em Verdana,sans-serif;float:left;display:inline}.b-share-popup__form__button{margin:5px 0 0 15px}.b-share-popup__form__close{font:86%/1.4545em Verdana,sans-serif;float:right;display:inline;padding:5px!important;margin:0 10px 5px 0;cursor:pointer;color:#999}a.b-share-popup__form__link:hover,a.b-share-popup__form__close:hover{text-decoration:underline;color:red}.b-share-popup_font_fixed .b-share-popup__item{font-size:12.8px}.b-share-popup_font_fixed .b-share-popup__header,.b-share-popup_font_fixed .b-share-popup__input,.b-share-popup_font_fixed .b-share-popup__expander .b-share-popup__item,.b-share-popup_font_fixed .b-share-popup__form__link,.b-share-popup_font_fixed .b-share-popup__form__button,.b-share-popup_font_fixed .b-share-popup__form__close{font-size:11px}.b-share-popup_font_fixed .b-share-popup__yandex{font-size:10px}.b-share-form-button{font:86%/17px Verdana,Arial,sans-serif;display:-moz-inline-box;display:inline-block;position:relative;height:19px;margin:0 3px;padding:0 4px;cursor:default;white-space:nowrap;text-decoration:none!important;color:#000!important;border:none;outline:none;background:url("//yastatic.net/share/static/b-share-form-button.png") 0 -20px repeat-x}.b-share-form-button:link:hover,.b-share-form-button:visited:hover{color:#000!important}.b-share-form-button__before,.b-share-form-button__after{position:absolute;width:3px;height:19px;background:url("//yastatic.net/share/static/b-share-form-button.png")}.b-share-form-button__before{margin-left:-7px}.b-share-form-button__after{margin-left:4px;background-position:-3px 0}.b-share-form-button::-moz-focus-inner{border:none}button.b-share-form-button .b-share-form-button__before,button.b-share-form-button .b-share-form-button__after{margin-top:-1px}@-moz-document url-prefix(){button.b-share-form-button .b-share-form-button__after{margin-top:-2px;margin-left:6px}button.b-share-form-button .b-share-form-button__before{margin-top:-2px;margin-left:-9px}}SPAN.b-share-form-button:hover,.b-share-form-button_state_hover{background-position:0 -60px}SPAN.b-share-form-button:hover .b-share-form-button__before,.b-share-form-button_state_hover .b-share-form-button__before{background-position:0 -40px}SPAN.b-share-form-button:hover .b-share-form-button__after,.b-share-form-button_state_hover .b-share-form-button__after{background-position:-3px -40px}.b-share-form-button_state_pressed,.b-share-form-button_state_pressed .b-share-form-button_share{background-position:0 -100px!important}.b-share-form-button_state_pressed .b-share-form-button__before{background-position:0 -80px!important}.b-share-form-button_state_pressed .b-share-form-button__after{background-position:-3px -80px!important}button.b-share-form-button_state_pressed{overflow:visible}.b-share-form-button_icons{position:relative;padding:0;background-position:0 -20px!important}.b-share-form-button_icons .b-share-form-button__before{left:0;margin-left:-3px;background-position:0 0!important}.b-share-form-button_icons .b-share-form-button__after{z-index:-1;margin-left:0;background-position:-3px 0!important}.b-share-form-button_icons .b-share__handle{padding:2px!important}.b-share-form-button_icons .b-share__handle_more{position:relative;padding-right:6px!important;margin-right:-4px}.b-share-form-button_icons .b-share-icon{opacity:.5;background-image:url("//yastatic.net/share/static/b-share-icon_size_14.png")}.b-share-form-button_icons A.b-share__handle:hover .b-share-icon{opacity:1}.b-share{font:86%/1.4545em Arial,sans-serif;display:-moz-inline-box;display:inline-block;padding:1px 3px 1px 4px!important;vertical-align:middle}.b-share .b-share-form-button{font-size:1em}.b-share__text .b-share-icon{margin:0 5px 0 0;border:none}.b-share__text{margin-right:5px}.b-share__handle{float:left;height:16px;padding:5px 3px 5px 2px!important;cursor:pointer;text-align:left;text-decoration:none!important}.b-share__handle_cursor_default{cursor:default}.b-share__handle .b-share-form-button{margin-top:-2px}.b-share__hr{display:none;float:left;width:1px;height:26px;margin:0 3px 0 2px}a.b-share__handle:hover .b-share__text{text-decoration:underline;color:red}.b-share_bordered{padding:0 2px 0 3px!important;border:1px solid #E4E4E4;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.b-share_bordered .b-share__hr{display:inline;background:#E4E4E4}.b-share_link{margin:-8px 0}a.b-share_link{margin:0}.b-share_link .b-share__text{text-decoration:underline;color:#1A3DC1}.b-share-form-button_share{padding-left:26px!important;vertical-align:top}.b-share-form-button_share .b-share-form-button__before{margin-left:-29px}.b-share-form-button_share .b-share-form-button__icon{position:absolute;width:20px;height:17px;margin:1px 0 0 -23px;background:url("//yastatic.net/share/static/b-share-form-button_share__icon.png") 0 0 no-repeat}.b-share-pseudo-link{border-bottom:1px dotted;cursor:pointer;text-decoration:none!important}.b-share_font_fixed{font-size:11px}.b-share__handle_more{font-size:9px;margin-top:-1px;color:#7B7B7B}A.b-share__handle_more:hover{color:#000}.b-share__group{float:left}.b-share-icon{float:left;display:inline;overflow:hidden;width:16px;height:16px;padding:0!important;vertical-align:top;border:0;background:url("//yastatic.net/share/static/b-share-icon.png") 0 99px no-repeat}.b-share-icon_vkontakte,.b-share-icon_custom{background-position:0 0}.b-share-icon_yaru,.b-share-icon_yaru_photo,.b-share-icon_yaru_wishlist{background-position:0 -17px}.b-share-icon_lj{background-position:0 -34px}.b-share-icon_twitter{background-position:0 -51px}.b-share-icon_facebook{background-position:0 -68px}.b-share-icon_moimir{background-position:0 -85px}.b-share-icon_friendfeed{background-position:0 -102px}.b-share-icon_mail{background-position:0 -119px}.b-share-icon_html{background-position:0 -136px}.b-share-icon_postcard{background-position:0 -153px}.b-share-icon_odnoklassniki{background-position:0 -170px}.b-share-icon_blogger{background-position:0 -187px}.b-share-icon_delicious{background-position:0 -221px}.b-share-icon_gbuzz{background-position:0 -238px}.b-share-icon_linkedin{background-position:0 -255px}.b-share-icon_myspace{background-position:0 -272px}.b-share-icon_evernote{background-position:0 -289px}.b-share-icon_digg{background-position:0 -306px}.b-share-icon_juick{background-position:0 -324px}.b-share-icon_moikrug{background-position:0 -341px}.b-share-icon_yazakladki{background-position:0 -358px}.b-share-icon_liveinternet{background-position:0 -375px}.b-share-icon_tutby{background-position:0 -392px}.b-share-icon_diary{background-position:0 -409px}.b-share-icon_gplus{background-position:0 -426px}.b-share-icon_pocket{background-position:0 -443px}.b-share-icon_surfingbird{background-position:0 -460px}.b-share-icon_pinterest{background-position:0 -477px}.b-share-icon_renren{background-position:0 0}.b-share-icon_renren,.b-share-icon_sina_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_sina_weibo{background-position:-18px 0}.b-share-icon_qzone{background-position:-36px 0}.b-share-icon_qzone,.b-share-icon_tencent_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_tencent_weibo{background-position:-54px 0}.b-share_theme_dark .b-share-icon{background:url("//yastatic.net/share/static/b-share-icons__theme_dark.png") 99px 0 no-repeat}.b-share_theme_dark .b-share-icon_odnoklassniki{background-position:-4px -3px}.b-share_theme_dark .b-share-icon_vkontakte{background-position:-24px -3px}.b-share_theme_dark .b-share-icon_twitter{background-position:-44px -3px}.b-share_theme_dark .b-share-icon_facebook{background-position:-64px -3px}.b-share_theme_dark .b-share-icon_lj{background-position:-85px -3px}.b-share_theme_dark .b-share-icon_yaru{background-position:-105px -3px}.b-share_theme_dark .b-share-popup .b-share-icon_odnoklassniki,.b-share_theme_dark .b-share-icon_odnoklassniki:hover{background-position:-4px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_vkontakte,.b-share_theme_dark .b-share-icon_vkontakte:hover{background-position:-24px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_twitter,.b-share_theme_dark .b-share-icon_twitter:hover{background-position:-44px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_facebook,.b-share_theme_dark .b-share-icon_facebook:hover{background-position:-64px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_lj,.b-share_theme_dark .b-share-icon_lj:hover{background-position:-85px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_yaru,.b-share_theme_dark .b-share-icon_yaru:hover{background-position:-105px -28px}.b-share_theme_dark .b-share-form-button_share .b-share-form-button__icon{background-image:url("//yastatic.net/share/static/b-share-form-button_share__icon_dark.png")}.b-share_theme_dark .b-share-form-button{color:#fff!important;opacity:.8}.b-share_theme_dark .b-share__handle:hover .b-share-form-button,.b-share_theme_dark .b-share-form-button:hover{opacity:1;cursor:pointer}.b-share_theme_dark .b-share-form-button,.b-share_theme_dark .b-share-form-button__before,.b-share_theme_dark .b-share-form-button__after{background:0 0}.b-share_theme_dark .b-share-popup__i{background-color:#333;border-radius:10px;-webkit-box-shadow:0 2px 9px rgba(255,255,255,.6);-moz-box-shadow:0 2px 9px rgba(255,255,255,.6);box-shadow:0 2px 9px rgba(255,255,255,.6)}.b-share_theme_dark .b-share__text{color:#AAA}.b-share_theme_dark .b-share-popup{color:#AAA;border-radius:10px;background-color:#333;background-color:rgba(50,50,50,.3)}.b-share_theme_dark .b-share-popup__item{background:0 0;color:#ccc}.b-share_theme_dark .b-share-popup .b-share-popup__item__text{color:#ccc}.b-share_theme_counter .b-share{display:inline-block;vertical-align:middle;white-space:nowrap}.b-share-counter{font:14px Arial,sans-serif;line-height:18px;display:none;float:left;margin:3px 6px 3px 3px;color:#fff}.b-share_theme_counter .b-share_type_small .b-share-counter{font-size:11px;line-height:14px;margin:2px 6px 2px 1px}.b-share_theme_counter .b-share-btn__counter .b-share-counter{display:block}.b-share-btn__counter{text-decoration:none}.b-share_theme_counter .b-share-btn__wrap{position:relative;float:left;margin-left:5px}.b-share_theme_counter .b-share_type_small .b-share-btn__wrap{margin-left:4px}.b-share_theme_counter .b-share-btn__wrap:first-child{margin-left:0}.b-share_theme_counter .b-share__link{display:inline-block;cursor:pointer;-webkit-border-radius:3px;border-radius:3px}.b-share_theme_counter .b-share_type_small .b-share__link{-webkit-border-radius:2px;border-radius:2px}.b-share_theme_counter .b-share-icon{display:block;float:left;width:24px;height:24px;background-image:url("//yastatic.net/share/static/b-share_counter_large.png");background-position:-20px 0}.b-share_theme_counter .b-share_type_small .b-share-icon{width:18px;height:18px;background-image:url("//yastatic.net/share/static/b-share_counter_small.png")}.b-share_theme_counter .b-share-icon_facebook{background-position:0 0}.b-share_theme_counter .b-share-btn__facebook{background-color:#3c5a98}.b-share_theme_counter .b-share-btn__facebook:hover{background-color:#30487a}.b-share_theme_counter .b-share-btn__facebook:active{border-top:2px solid #24365a;background-color:#334d81}.b-share_theme_counter .b-share-icon_moimir{background-position:0 -29px}.b-share_theme_counter .b-share-btn__moimir{background-color:#226eb7}.b-share_theme_counter .b-share-btn__moimir:hover{background-color:#1b5892}.b-share_theme_counter .b-share-btn__moimir:active{border-top:2px solid #14426d;background-color:#1d5e9c}.b-share_theme_counter .b-share-icon_vkontakte{background-position:0 -58px}.b-share_theme_counter .b-share-btn__vkontakte{background-color:#48729e}.b-share_theme_counter .b-share-btn__vkontakte:hover{background-color:#3a5b7e}.b-share_theme_counter .b-share-btn__vkontakte:active{border-top:2px solid #2b445e;background-color:#3d6186}.b-share_theme_counter .b-share-icon_twitter{background-position:0 -87px}.b-share_theme_counter .b-share-btn__twitter{background-color:#00aced}.b-share_theme_counter .b-share-btn__twitter:hover{background-color:#008abe}.b-share_theme_counter .b-share-btn__twitter:active{border-top:2px solid #00668d;background-color:#0092ca}.b-share_theme_counter .b-share-icon_odnoklassniki{background-position:0 -116px}.b-share_theme_counter .b-share-btn__odnoklassniki{background-color:#ff9f4d}.b-share_theme_counter .b-share-btn__odnoklassniki:hover{background-color:#cc7f3e}.b-share_theme_counter .b-share-btn__odnoklassniki:active{border-top:2px solid #975e2e;background-color:#d98742}.b-share_theme_counter .b-share-icon_gplus{background-position:0 -145px}.b-share_theme_counter .b-share-btn__gplus{background-color:#c25234}.b-share_theme_counter .b-share-btn__gplus:hover{background-color:#9b422a}.b-share_theme_counter .b-share-btn__gplus:active{border-top:2px solid #73311f;background-color:#a5462c}.b-share_theme_counter .b-share-icon_yaru{background-position:0 -174px}.b-share_theme_counter .b-share-btn__yaru{background-color:#d83933}.b-share_theme_counter .b-share-btn__yaru:hover{background-color:#ad2e29}.b-share_theme_counter .b-share-btn__yaru:active{border-top:2px solid #80221e;background-color:#b8312b}.b-share_theme_counter .b-share-icon_pinterest{background-position:0 -203px}.b-share_theme_counter .b-share-btn__pinterest{background-color:#cd1e27}.b-share_theme_counter .b-share-btn__pinterest:hover{background-color:#a4181f}.b-share_theme_counter .b-share-btn__pinterest:active{border-top:2px solid #7b1217;background-color:#ae1921}.b-share_theme_counter .b-share__link:active{height:22px}.b-share_theme_counter .b-share_type_small .b-share__link:active{height:16px}.b-share_theme_counter .b-share__link:active .b-share-icon,.b-share_theme_counter .b-share__link:active .b-share-counter{position:relative;top:-1px}.b-share_theme_counter .b-share__link::after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)}.b-share_theme_counter .b-share__handle{height:auto;padding:0!important}</style></head><body>
						<script type="text/javascript" src="Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability_files/hightlight_lib.js"></script>
						<script type="text/javascript" src="Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability_files/plain.js"></script>
						
						<link type="text/css" rel="stylesheet" href="Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability_files/hightlight_style.css">
						<script type="text/javascript">SyntaxHighlighter.all();</script>
						
						<center><h2>Contao CMS 3.2.4 Code Execution Vulnerability</h2></center>
						[ <a href="http://1337day.com/">home</a> ] [ <a href="http://1337day.com/exploit/description/21858">description</a> ]
						
						<br><br>
						<style>
							.view_table{vertical-align:top; border-collapse: collapse;}
							.view_table tr>TD{width:150px; vertical-align:top; border:1px dashed #474747;}
							.view_table tr>TD+TD{width:550px; vertical-align:top; border:1px dashed #474747;}
							/*border: 1px dashed #2F6FAB*/
						</style>
						<table class="view_table" cellpadding="3" cellspacing="0" border="0">
							<tbody><tr>
								<td style="">Full title</td>
								<td style="">
									Contao CMS 3.2.4 Code Execution Vulnerability
								</td>
							</tr>
							<tr>
								<td style="">Date add</td>
								<td style="">
									<a href="http://1337day.com/date/05-02-2014">05-02-2014</a>
								</td>
							</tr>
							<tr>
								<td style="">Category</td>
								<td style="">
									<a href="http://1337day.com/webapps">web applications</a>
								</td>
							</tr>
							<tr>
								<td style="">Platform</td>
								<td style="">
									<a href="http://1337day.com/platforms/php">php</a>
								</td>
							</tr>
							<tr>
								<td style="">Risk</td>
								<td style="">
									<div class="tips_risk_color_3">Security Risk High</div>
								</td>
							</tr>
									<tr>
										<td style="">CVE</td>
										<td style="">
											CVE-2014-1860
										</td>
									</tr>
								</tbody></table><br>
							<strong>Description:</strong><br>
								Contao CMS versions 3.2.4 and below suffer from a code execution vulnerability.
							<br>
						<div><div id="highlighter_65321" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div><div class="line number243 index242 alt2">243</div><div class="line number244 index243 alt1">244</div><div class="line number245 index244 alt2">245</div><div class="line number246 index245 alt1">246</div><div class="line number247 index246 alt2">247</div><div class="line number248 index247 alt1">248</div><div class="line number249 index248 alt2">249</div><div class="line number250 index249 alt1">250</div><div class="line number251 index250 alt2">251</div><div class="line number252 index251 alt1">252</div><div class="line number253 index252 alt2">253</div><div class="line number254 index253 alt1">254</div><div class="line number255 index254 alt2">255</div><div class="line number256 index255 alt1">256</div><div class="line number257 index256 alt2">257</div><div class="line number258 index257 alt1">258</div><div class="line number259 index258 alt2">259</div><div class="line number260 index259 alt1">260</div><div class="line number261 index260 alt2">261</div><div class="line number262 index261 alt1">262</div><div class="line number263 index262 alt2">263</div><div class="line number264 index263 alt1">264</div><div class="line number265 index264 alt2">265</div><div class="line number266 index265 alt1">266</div><div class="line number267 index266 alt2">267</div><div class="line number268 index267 alt1">268</div><div class="line number269 index268 alt2">269</div><div class="line number270 index269 alt1">270</div><div class="line number271 index270 alt2">271</div><div class="line number272 index271 alt1">272</div><div class="line number273 index272 alt2">273</div><div class="line number274 index273 alt1">274</div><div class="line number275 index274 alt2">275</div><div class="line number276 index275 alt1">276</div><div class="line number277 index276 alt2">277</div><div class="line number278 index277 alt1">278</div><div class="line number279 index278 alt2">279</div><div class="line number280 index279 alt1">280</div><div class="line number281 index280 alt2">281</div><div class="line number282 index281 alt1">282</div><div class="line number283 index282 alt2">283</div><div class="line number284 index283 alt1">284</div><div class="line number285 index284 alt2">285</div><div class="line number286 index285 alt1">286</div><div class="line number287 index286 alt2">287</div><div class="line number288 index287 alt1">288</div><div class="line number289 index288 alt2">289</div><div class="line number290 index289 alt1">290</div><div class="line number291 index290 alt2">291</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Hi,</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">I have discovered a vulnerability that might lead to code execution in</code></div><div class="line number4 index3 alt1"><code class="plain plain">Contao CMS &lt;= 3.2.4</code></div><div class="line number5 index4 alt2"><code class="plain plain">Contao CMS &lt;= 3.2.4 does not properly validate user input in several</code></div><div class="line number6 index5 alt1"><code class="plain plain">locations which is then passed directly into PHP's unserialize.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="plain plain">This has been fixed in Contao 3.2.5 as per commit:</code></div><div class="line number9 index8 alt2"><code class="plain plain"><a href="https://github.com/contao/core/commit/8c9cb044bdc887a8202bb65a64545c025664f957">https://github.com/contao/core/commit/8c9cb044bdc887a8202bb65a64545c025664f957</a></code></div><div class="line number10 index9 alt1"><code class="plain plain">and</code></div><div class="line number11 index10 alt2"><code class="plain plain"><a href="https://github.com/contao/core/commit/1717336598fdcf1ed3f4ad488e140147cb31516d">https://github.com/contao/core/commit/1717336598fdcf1ed3f4ad488e140147cb31516d</a></code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="plain plain">Announcements can be found at</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="plain plain"><a href="https://contao.org/en/news/contao-3_2_5.html">https://contao.org/en/news/contao-3_2_5.html</a></code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="plain plain"><a href="https://contao.org/en/news/contao-2_11_14.html">https://contao.org/en/news/contao-2_11_14.html</a></code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="plain plain">Thanks to the Contao developers for being so responsive.</code></div><div class="line number20 index19 alt1"><code class="plain plain">The full report can be found at my repo in</code></div><div class="line number21 index20 alt2"><code class="plain plain"><a href="https://github.com/pedrib/PoC/blob/master/contao-3.2.4.txt">https://github.com/pedrib/PoC/blob/master/contao-3.2.4.txt</a></code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="plain plain">Regards,</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="plain plain">Pedro Ribeiro</code></div><div class="line number26 index25 alt1"><code class="plain plain">Agile Information Security</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="plain plain">------</code></div><div class="line number30 index29 alt1"><code class="plain plain">Proof of concept:</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="plain plain">&gt; Vulnerabilities in Contao 3.2.4</code></div><div class="line number33 index32 alt2"><code class="plain plain">&gt; Discovered by Pedro Ribeiro (pedrib@gmail.com) of Agile Information Security</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="plain plain">====================================================================</code></div><div class="line number36 index35 alt1"><code class="plain plain">Vulnerability: PHP object injection leading to all kinds of badness</code></div><div class="line number37 index36 alt2"><code class="plain plain">File(line): contao-core-3.2.4/system/modules/core/drivers/DC_Table.php(149)</code></div><div class="line number38 index37 alt1"><code class="plain plain">File(line): contao-core-3.2.4/system/modules/core/drivers/DC_Folder.php(124)</code></div><div class="line number39 index38 alt2"><code class="plain plain">File(line): contao-core-3.2.4/system/modules/core/widgets/KeyValueWizard.php(73)</code></div><div class="line number40 index39 alt1"><code class="plain plain">File(line): Potentially many others that call deserialize with user input</code></div><div class="line number41 index40 alt2"><code class="plain plain">Code snippet:</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="plain plain">contao-core-3.2.4/system/modules/core/drivers/DC_Table.php(149):</code></div><div class="line number44 index43 alt1"><code class="plain plain">if (\Input::post('FORM_SUBMIT') == 'tl_select')</code></div><div class="line number45 index44 alt2"><code class="plain plain">{</code></div><div class="line number46 index45 alt1"><code class="plain plain">$ids = deserialize(\Input::post('IDS'));</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="plain plain">if (!is_array($ids) || empty($ids))</code></div><div class="line number49 index48 alt2"><code class="plain plain">{</code></div><div class="line number50 index49 alt1"><code class="plain plain">$this-&gt;reload();</code></div><div class="line number51 index50 alt2"><code class="plain plain">}</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="plain plain">$session = $this-&gt;Session-&gt;getData();</code></div><div class="line number54 index53 alt1"><code class="plain plain">$session['CURRENT']['IDS'] = deserialize(\Input::post('IDS'));</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1">&nbsp;</div><div class="line number57 index56 alt2"><code class="plain plain">contao-core-3.2.4/system/modules/core/drivers/DC_Folder.php(124):</code></div><div class="line number58 index57 alt1"><code class="plain plain">if (\Input::post('FORM_SUBMIT') == 'tl_select')</code></div><div class="line number59 index58 alt2"><code class="plain plain">{</code></div><div class="line number60 index59 alt1"><code class="plain plain">$ids = deserialize(\Input::post('IDS'));</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="plain plain">contao-core-3.2.4/system/modules/core/widgets/KeyValueWizard.php(73)</code></div><div class="line number64 index63 alt1"><code class="plain plain">public function validate()</code></div><div class="line number65 index64 alt2"><code class="plain plain">{</code></div><div class="line number66 index65 alt1"><code class="plain plain">$mandatory = $this-&gt;mandatory;</code></div><div class="line number67 index66 alt2"><code class="plain plain">$options = deserialize($this-&gt;getPost($this-&gt;strName));</code></div><div class="line number68 index67 alt1">&nbsp;</div><div class="line number69 index68 alt2">&nbsp;</div><div class="line number70 index69 alt1"><code class="plain plain">deserialize from functions.php (starting at line 280):</code></div><div class="line number71 index70 alt2"><code class="plain plain">/**</code></div><div class="line number72 index71 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">* Return an unserialized array or the argument</code></div><div class="line number73 index72 alt2"><code class="plain spaces">&nbsp;</code><code class="plain plain">* @param mixed</code></div><div class="line number74 index73 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">* @param boolean</code></div><div class="line number75 index74 alt2"><code class="plain spaces">&nbsp;</code><code class="plain plain">* @return mixed</code></div><div class="line number76 index75 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">*/</code></div><div class="line number77 index76 alt2"><code class="plain plain">function deserialize($varValue, $blnForceArray=false)</code></div><div class="line number78 index77 alt1"><code class="plain plain">{</code></div><div class="line number79 index78 alt2"><code class="plain plain">if (is_array($varValue))</code></div><div class="line number80 index79 alt1"><code class="plain plain">{</code></div><div class="line number81 index80 alt2"><code class="plain plain">return $varValue;</code></div><div class="line number82 index81 alt1"><code class="plain plain">}</code></div><div class="line number83 index82 alt2">&nbsp;</div><div class="line number84 index83 alt1"><code class="plain plain">if (!is_string($varValue))</code></div><div class="line number85 index84 alt2"><code class="plain plain">{</code></div><div class="line number86 index85 alt1"><code class="plain plain">return $blnForceArray ? (($varValue === null) ? array() : array($varValue)) : $varValue;</code></div><div class="line number87 index86 alt2"><code class="plain plain">}</code></div><div class="line number88 index87 alt1"><code class="plain plain">elseif (trim($varValue) == '')</code></div><div class="line number89 index88 alt2"><code class="plain plain">{</code></div><div class="line number90 index89 alt1"><code class="plain plain">return $blnForceArray ? array() : '';</code></div><div class="line number91 index90 alt2"><code class="plain plain">}</code></div><div class="line number92 index91 alt1">&nbsp;</div><div class="line number93 index92 alt2"><code class="plain plain">$varUnserialized = @unserialize($varValue);</code></div><div class="line number94 index93 alt1">&nbsp;</div><div class="line number95 index94 alt2"><code class="plain plain">if (is_array($varUnserialized))</code></div><div class="line number96 index95 alt1"><code class="plain plain">{</code></div><div class="line number97 index96 alt2"><code class="plain plain">$varValue = $varUnserialized;</code></div><div class="line number98 index97 alt1"><code class="plain plain">}</code></div><div class="line number99 index98 alt2"><code class="plain plain">elseif ($blnForceArray)</code></div><div class="line number100 index99 alt1"><code class="plain plain">{</code></div><div class="line number101 index100 alt2"><code class="plain plain">$varValue = array($varValue);</code></div><div class="line number102 index101 alt1"><code class="plain plain">}</code></div><div class="line number103 index102 alt2">&nbsp;</div><div class="line number104 index103 alt1"><code class="plain plain">return $varValue;</code></div><div class="line number105 index104 alt2"><code class="plain plain">}</code></div><div class="line number106 index105 alt1">&nbsp;</div><div class="line number107 index106 alt2">&nbsp;</div><div class="line number108 index107 alt1"><code class="plain plain">The
 Input class does good validation on POST and GET variables for XSS, but
 in this case it provides no protection because the malicious data is a 
well formed PHP object.</code></div><div class="line number109 index108 alt2">&nbsp;</div><div class="line number110 index109 alt1"><code class="plain plain">post from Input class:</code></div><div class="line number111 index110 alt2"><code class="plain plain">public static function post($strKey, $blnDecodeEntities=false)</code></div><div class="line number112 index111 alt1"><code class="plain plain">{</code></div><div class="line number113 index112 alt2"><code class="plain plain">$strCacheKey = $blnDecodeEntities ? 'postDecoded' : 'postEncoded';</code></div><div class="line number114 index113 alt1">&nbsp;</div><div class="line number115 index114 alt2"><code class="plain plain">if (!isset(static::$arrCache[$strCacheKey][$strKey]))</code></div><div class="line number116 index115 alt1"><code class="plain plain">{</code></div><div class="line number117 index116 alt2"><code class="plain plain">$varValue = static::findPost($strKey);</code></div><div class="line number118 index117 alt1">&nbsp;</div><div class="line number119 index118 alt2"><code class="plain plain">if ($varValue === null)</code></div><div class="line number120 index119 alt1"><code class="plain plain">{</code></div><div class="line number121 index120 alt2"><code class="plain plain">return $varValue;</code></div><div class="line number122 index121 alt1"><code class="plain plain">}</code></div><div class="line number123 index122 alt2">&nbsp;</div><div class="line number124 index123 alt1"><code class="plain plain">$varValue = static::stripSlashes($varValue);</code></div><div class="line number125 index124 alt2"><code class="plain plain">$varValue = static::decodeEntities($varValue);</code></div><div class="line number126 index125 alt1"><code class="plain plain">$varValue = static::xssClean($varValue, true);</code></div><div class="line number127 index126 alt2"><code class="plain plain">$varValue = static::stripTags($varValue);</code></div><div class="line number128 index127 alt1">&nbsp;</div><div class="line number129 index128 alt2"><code class="plain plain">if (!$blnDecodeEntities)</code></div><div class="line number130 index129 alt1"><code class="plain plain">{</code></div><div class="line number131 index130 alt2"><code class="plain plain">$varValue = static::encodeSpecialChars($varValue);</code></div><div class="line number132 index131 alt1"><code class="plain plain">}</code></div><div class="line number133 index132 alt2">&nbsp;</div><div class="line number134 index133 alt1"><code class="plain plain">static::$arrCache[$strCacheKey][$strKey] = $varValue;</code></div><div class="line number135 index134 alt2"><code class="plain plain">}</code></div><div class="line number136 index135 alt1">&nbsp;</div><div class="line number137 index136 alt2"><code class="plain plain">return static::$arrCache[$strCacheKey][$strKey];</code></div><div class="line number138 index137 alt1"><code class="plain plain">}</code></div><div class="line number139 index138 alt2">&nbsp;</div><div class="line number140 index139 alt1">&nbsp;</div><div class="line number141 index140 alt2"><code class="plain plain">getPost from Widget class (starting at line 722):</code></div><div class="line number142 index141 alt1"><code class="plain plain">/**</code></div><div class="line number143 index142 alt2"><code class="plain spaces">&nbsp;</code><code class="plain plain">* Find and return a $_POST variable</code></div><div class="line number144 index143 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">*</code></div><div class="line number145 index144 alt2"><code class="plain spaces">&nbsp;</code><code class="plain plain">* @param string $strKey The variable name</code></div><div class="line number146 index145 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">*</code></div><div class="line number147 index146 alt2"><code class="plain spaces">&nbsp;</code><code class="plain plain">* @return mixed The variable value</code></div><div class="line number148 index147 alt1"><code class="plain spaces">&nbsp;</code><code class="plain plain">*/</code></div><div class="line number149 index148 alt2"><code class="plain plain">protected function getPost($strKey)</code></div><div class="line number150 index149 alt1"><code class="plain plain">{</code></div><div class="line number151 index150 alt2"><code class="plain plain">$strMethod = $this-&gt;allowHtml ? 'postHtml' : 'post';</code></div><div class="line number152 index151 alt1">&nbsp;</div><div class="line number153 index152 alt2"><code class="plain plain">if ($this-&gt;preserveTags)</code></div><div class="line number154 index153 alt1"><code class="plain plain">{</code></div><div class="line number155 index154 alt2"><code class="plain plain">$strMethod = 'postRaw';</code></div><div class="line number156 index155 alt1"><code class="plain plain">}</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="plain plain">// Support arrays (thanks to Andreas Schempp)</code></div><div class="line number159 index158 alt2"><code class="plain plain">$arrParts = explode('[', str_replace(']', '', $strKey));</code></div><div class="line number160 index159 alt1">&nbsp;</div><div class="line number161 index160 alt2"><code class="plain plain">if (!empty($arrParts))</code></div><div class="line number162 index161 alt1"><code class="plain plain">{</code></div><div class="line number163 index162 alt2"><code class="plain plain">$varValue = \Input::$strMethod(array_shift($arrParts), $this-&gt;decodeEntities);</code></div><div class="line number164 index163 alt1">&nbsp;</div><div class="line number165 index164 alt2"><code class="plain plain">foreach($arrParts as $part)</code></div><div class="line number166 index165 alt1"><code class="plain plain">{</code></div><div class="line number167 index166 alt2"><code class="plain plain">if (!is_array($varValue))</code></div><div class="line number168 index167 alt1"><code class="plain plain">{</code></div><div class="line number169 index168 alt2"><code class="plain plain">break;</code></div><div class="line number170 index169 alt1"><code class="plain plain">}</code></div><div class="line number171 index170 alt2">&nbsp;</div><div class="line number172 index171 alt1"><code class="plain plain">$varValue = $varValue[$part];</code></div><div class="line number173 index172 alt2"><code class="plain plain">}</code></div><div class="line number174 index173 alt1">&nbsp;</div><div class="line number175 index174 alt2"><code class="plain plain">return $varValue;</code></div><div class="line number176 index175 alt1"><code class="plain plain">}</code></div><div class="line number177 index176 alt2">&nbsp;</div><div class="line number178 index177 alt1"><code class="plain plain">return \Input::$strMethod($strKey, $this-&gt;decodeEntities);</code></div><div class="line number179 index178 alt2"><code class="plain plain">}</code></div><div class="line number180 index179 alt1">&nbsp;</div><div class="line number181 index180 alt2">&nbsp;</div><div class="line number182 index181 alt1"><code class="plain plain">There are a few magic methods that seem exploitable.</code></div><div class="line number183 index182 alt2"><code class="plain plain">For
 example on 
contao-core-3.2.4/system/modules/core/classes/FrontendUser.php, it might
 be possible to overwrite the admin session with another session by 
manipulating the intId parameter (which is the userID):</code></div><div class="line number184 index183 alt1"><code class="plain plain">public function __destruct()</code></div><div class="line number185 index184 alt2"><code class="plain plain">{</code></div><div class="line number186 index185 alt1"><code class="plain plain">$session = $this-&gt;Session-&gt;getData();</code></div><div class="line number187 index186 alt2">&nbsp;</div><div class="line number188 index187 alt1"><code class="plain plain">if
 (!isset($_GET['pdf']) &amp;&amp; !isset($_GET['file']) &amp;&amp; 
!isset($_GET['id']) &amp;&amp; $session['referer']['current'] != 
\Environment::get('requestUri'))</code></div><div class="line number189 index188 alt2"><code class="plain plain">{</code></div><div class="line number190 index189 alt1"><code class="plain plain">$session['referer']['last'] = $session['referer']['current'];</code></div><div class="line number191 index190 alt2"><code class="plain plain">$session['referer']['current'] = substr(\Environment::get('requestUri'), strlen(TL_PATH) + 1);</code></div><div class="line number192 index191 alt1"><code class="plain plain">}</code></div><div class="line number193 index192 alt2">&nbsp;</div><div class="line number194 index193 alt1"><code class="plain plain">$this-&gt;Session-&gt;setData($session);</code></div><div class="line number195 index194 alt2">&nbsp;</div><div class="line number196 index195 alt1"><code class="plain plain">if ($this-&gt;intId)</code></div><div class="line number197 index196 alt2"><code class="plain plain">{</code></div><div class="line number198 index197 alt1"><code class="plain plain">$this-&gt;Database-&gt;prepare("UPDATE " . $this-&gt;strTable . " SET session=? WHERE id=?")</code></div><div class="line number199 index198 alt2"><code class="plain plain">-&gt;execute(serialize($session), $this-&gt;intId);</code></div><div class="line number200 index199 alt1"><code class="plain plain">}</code></div><div class="line number201 index200 alt2"><code class="plain plain">}</code></div><div class="line number202 index201 alt1">&nbsp;</div><div class="line number203 index202 alt2">&nbsp;</div><div class="line number204 index203 alt1"><code class="plain plain">Overwriting configuration files in contao-core-3.2.4/system/modules/core/library/Contao/Config.php</code></div><div class="line number205 index204 alt2">&nbsp;</div><div class="line number206 index205 alt1"><code class="plain plain">/**</code></div><div class="line number207 index206 alt2"><code class="plain plain">* Automatically save the local configuration</code></div><div class="line number208 index207 alt1"><code class="plain plain">*/</code></div><div class="line number209 index208 alt2"><code class="plain plain">public function __destruct()</code></div><div class="line number210 index209 alt1"><code class="plain plain">{</code></div><div class="line number211 index210 alt2"><code class="plain plain">if ($this-&gt;blnIsModified)</code></div><div class="line number212 index211 alt1"><code class="plain plain">{</code></div><div class="line number213 index212 alt2"><code class="plain plain">$this-&gt;save();</code></div><div class="line number214 index213 alt1"><code class="plain plain">}</code></div><div class="line number215 index214 alt2"><code class="plain plain">}</code></div><div class="line number216 index215 alt1">&nbsp;</div><div class="line number217 index216 alt2">&nbsp;</div><div class="line number218 index217 alt1"><code class="plain plain">public function save()</code></div><div class="line number219 index218 alt2"><code class="plain plain">{</code></div><div class="line number220 index219 alt1"><code class="plain plain">if ($this-&gt;strTop == '')</code></div><div class="line number221 index220 alt2"><code class="plain plain">{</code></div><div class="line number222 index221 alt1"><code class="plain plain">$this-&gt;strTop = '&lt;?php';</code></div><div class="line number223 index222 alt2"><code class="plain plain">}</code></div><div class="line number224 index223 alt1">&nbsp;</div><div class="line number225 index224 alt2"><code class="plain plain">$strFile = trim($this-&gt;strTop) . "\n\n";</code></div><div class="line number226 index225 alt1"><code class="plain plain">$strFile .= "### INSTALL SCRIPT START ###\n";</code></div><div class="line number227 index226 alt2">&nbsp;</div><div class="line number228 index227 alt1"><code class="plain plain">foreach ($this-&gt;arrData as $k=&gt;$v)</code></div><div class="line number229 index228 alt2"><code class="plain plain">{</code></div><div class="line number230 index229 alt1"><code class="plain plain">$strFile .= "$k = $v\n";</code></div><div class="line number231 index230 alt2"><code class="plain plain">}</code></div><div class="line number232 index231 alt1">&nbsp;</div><div class="line number233 index232 alt2"><code class="plain plain">$strFile .= "### INSTALL SCRIPT STOP ###\n";</code></div><div class="line number234 index233 alt1"><code class="plain plain">$this-&gt;strBottom = trim($this-&gt;strBottom);</code></div><div class="line number235 index234 alt2">&nbsp;</div><div class="line number236 index235 alt1"><code class="plain plain">if ($this-&gt;strBottom != '')</code></div><div class="line number237 index236 alt2"><code class="plain plain">{</code></div><div class="line number238 index237 alt1"><code class="plain plain">$strFile .= "\n" . $this-&gt;strBottom . "\n";</code></div><div class="line number239 index238 alt2"><code class="plain plain">}</code></div><div class="line number240 index239 alt1">&nbsp;</div><div class="line number241 index240 alt2"><code class="plain plain">$strTemp = md5(uniqid(mt_rand(), true));</code></div><div class="line number242 index241 alt1">&nbsp;</div><div class="line number243 index242 alt2"><code class="plain plain">// Write to a temp file first</code></div><div class="line number244 index243 alt1"><code class="plain plain">$objFile = fopen(TL_ROOT . '/system/tmp/' . $strTemp, 'wb');</code></div><div class="line number245 index244 alt2"><code class="plain plain">fputs($objFile, $strFile);</code></div><div class="line number246 index245 alt1"><code class="plain plain">fclose($objFile);</code></div><div class="line number247 index246 alt2">&nbsp;</div><div class="line number248 index247 alt1"><code class="plain plain">// Make sure the file has been written (see #4483)</code></div><div class="line number249 index248 alt2"><code class="plain plain">if (!filesize(TL_ROOT . '/system/tmp/' . $strTemp))</code></div><div class="line number250 index249 alt1"><code class="plain plain">{</code></div><div class="line number251 index250 alt2"><code class="plain plain">\System::log('The local configuration file could not be written. Have your reached your quota limit?', __METHOD__, TL_ERROR);</code></div><div class="line number252 index251 alt1"><code class="plain plain">return;</code></div><div class="line number253 index252 alt2"><code class="plain plain">}</code></div><div class="line number254 index253 alt1">&nbsp;</div><div class="line number255 index254 alt2"><code class="plain plain">// Then move the file to its final destination</code></div><div class="line number256 index255 alt1"><code class="plain plain">$this-&gt;Files-&gt;rename('system/tmp/' . $strTemp, 'system/config/localconfig.php');</code></div><div class="line number257 index256 alt2">&nbsp;</div><div class="line number258 index257 alt1">&nbsp;</div><div class="line number259 index258 alt2"><code class="plain plain">Arbitrary file deletion in contao-core-3.2.4/system/modules/core/library/Contao/ZipWriter.php:</code></div><div class="line number260 index259 alt1"><code class="plain plain">public function __destruct()</code></div><div class="line number261 index260 alt2"><code class="plain plain">{</code></div><div class="line number262 index261 alt1"><code class="plain plain">if (is_resource($this-&gt;resFile))</code></div><div class="line number263 index262 alt2"><code class="plain plain">{</code></div><div class="line number264 index263 alt1"><code class="plain plain">@fclose($this-&gt;resFile);</code></div><div class="line number265 index264 alt2"><code class="plain plain">}</code></div><div class="line number266 index265 alt1">&nbsp;</div><div class="line number267 index266 alt2"><code class="plain plain">if (file_exists($this-&gt;strTemp))</code></div><div class="line number268 index267 alt1"><code class="plain plain">{</code></div><div class="line number269 index268 alt2"><code class="plain plain">@unlink($this-&gt;strTemp);</code></div><div class="line number270 index269 alt1"><code class="plain plain">}</code></div><div class="line number271 index270 alt2">&nbsp;</div><div class="line number272 index271 alt1">&nbsp;</div><div class="line number273 index272 alt2"><code class="plain plain">Again
 arbitrary file deletion in 
contao-core-3.2.4/system/modules/core/vendor/swiftmailer/classes/Swift/ByteStream/TemporaryFileByteStream.php:</code></div><div class="line number274 index273 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">public function __destruct()</code></div><div class="line number275 index274 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number276 index275 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if (file_exists($this-&gt;getPath())) {</code></div><div class="line number277 index276 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">@unlink($this-&gt;getPath());</code></div><div class="line number278 index277 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number279 index278 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number280 index279 alt1">&nbsp;</div><div class="line number281 index280 alt2">&nbsp;</div><div class="line number282 index281 alt1"><code class="plain plain">Comment:</code></div><div class="line number283 index282 alt2"><code class="plain plain">User input is passed directly into unserialize(), possibly leading to code execution.</code></div><div class="line number284 index283 alt1">&nbsp;</div><div class="line number285 index284 alt2"><code class="plain plain">References:</code></div><div class="line number286 index285 alt1"><code class="plain plain"><a href="https://www.owasp.org/index.php/PHP_Object_Injection">https://www.owasp.org/index.php/PHP_Object_Injection</a></code></div><div class="line number287 index286 alt2"><code class="plain plain"><a href="http://www.alertlogic.com/writing-exploits-for-exotic-bug-classes/">http://www.alertlogic.com/writing-exploits-for-exotic-bug-classes/</a></code></div><div class="line number288 index287 alt1"><code class="plain plain"><a href="http://www.suspekt.org/downloads/POC2009-ShockingNewsInPHPExploitation.pdf">http://www.suspekt.org/downloads/POC2009-ShockingNewsInPHPExploitation.pdf</a></code></div><div class="line number289 index288 alt2"><code class="plain plain"><a href="http://vagosec.org/2013/12/wordpress-rce-exploit/">http://vagosec.org/2013/12/wordpress-rce-exploit/</a></code></div><div class="line number290 index289 alt1">&nbsp;</div><div class="line number291 index290 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">#&nbsp; 1337day.com [2015-02-15]&nbsp; #</code></div></div></td></tr></tbody></table></div></div><script type="text/javascript" src="Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability_files/share.js" charset="utf-8"></script>
						<div id="share" class="yashare-auto-init" data-yasharel10n="ru" data-yasharetype="none" data-yasharequickservices="facebook,twitter,gplus,vkontakte"><span class="b-share"><a rel="nofollow" target="_blank" title="Facebook" class="b-share__handle b-share__link b-share-btn__facebook" href="http://share.yandex.ru/go.xml?service=facebook&amp;url=http%3A%2F%2F1337day.com%2Fexploit%2F21858&amp;title=Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability" data-service="facebook"><span class="b-share-icon b-share-icon_facebook"></span></a><a rel="nofollow" target="_blank" title="Twitter" class="b-share__handle b-share__link b-share-btn__twitter" href="http://share.yandex.ru/go.xml?service=twitter&amp;url=http%3A%2F%2F1337day.com%2Fexploit%2F21858&amp;title=Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability" data-service="twitter"><span class="b-share-icon b-share-icon_twitter"></span></a><a rel="nofollow" target="_blank" title="Google Plus" class="b-share__handle b-share__link b-share-btn__gplus" href="http://share.yandex.ru/go.xml?service=gplus&amp;url=http%3A%2F%2F1337day.com%2Fexploit%2F21858&amp;title=Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability" data-service="gplus"><span class="b-share-icon b-share-icon_gplus"></span></a><a rel="nofollow" target="_blank" title="ВКонтакте" class="b-share__handle b-share__link b-share-btn__vkontakte" href="http://share.yandex.ru/go.xml?service=vkontakte&amp;url=http%3A%2F%2F1337day.com%2Fexploit%2F21858&amp;title=Contao%20CMS%203.2.4%20Code%20Execution%20Vulnerability" data-service="vkontakte"><span class="b-share-icon b-share-icon_vkontakte"></span></a></span></div></body></html>